<script src="js/handlebars-v4.0.5.js"></script>
<script id="search-results-template" type="text/x-handlebars-template">
  <div class="row num-results-container">
    <span id="num-results">{{numPosts}} results</span>
  </div>
  <div class="row container-fluid list-container">
    <table id="list" class="table">
      {{#each posts}}
        <tr class="row">
          <td class="col-md-1 score">
            {{data.score}}
          </td>
          <td class="col-md-3 post-thumbnail">
            <img src="{{data.thumbnail}}" width="60px" height="60px">
          </td>
          <td class="col-md-7 title">
              <span>
                <a href="https://www.reddit.com{{data.permalink}}">
                  <span class="post-title">{{data.title}}</span>
                </a>
                <br/>
                <small class="post-details">
                  submitted ~{{data.age}} ago by 
                  <a href="https://www.reddit.com/u/{{data.author}}">/u/{{data.author}}</a>
                </small>
                <br/>
                <a href="https://www.reddit.com{{data.permalink}}">
                  <span class="num-comments">{{data.num_comments}} comments</span>
                </a>
              </span>
          </td>
          <td class="col-md-1 subreddit">
            <a href="https://www.reddit.com/r/{{data.subreddit}}">/r/{{data.subreddit}}</a>
          </td>
        </tr>
      {{/each}}
    </table>
  </div>
</script>

<script>
  var template = Handlebars.compile(document.getElementById("search-results-template").innerHTML);
  window.addEventListener('message', function(event) {
    event.source.postMessage({
      html: template(event.data.context)
    }, event.origin);
  });
</script>
